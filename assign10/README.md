I did bonus and added test cases for derivatives, thank you.
